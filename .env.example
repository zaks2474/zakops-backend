# =============================================================================
# ZakOps Backend Configuration
# =============================================================================

# =============================================================================
# Database Configuration
# =============================================================================

# Primary database backend: "sqlite" or "postgresql"
# - sqlite: Use SQLite (legacy action engine)
# - postgresql: Use PostgreSQL (target state)
DATABASE_BACKEND=postgresql

# PostgreSQL connection (used when DATABASE_BACKEND=postgresql)
DATABASE_URL=postgresql://dealengine:changeme@localhost:5435/zakops

# SQLite path (used when DATABASE_BACKEND=sqlite or DUAL_WRITE_ENABLED=true)
SQLITE_PATH=/home/zaks/DataRoom/.deal-registry/ingest_state.db
ZAKOPS_STATE_DB=/home/zaks/DataRoom/.deal-registry/ingest_state.db

# Dual-write mode: Write to both SQLite and PostgreSQL during migration
# When enabled, writes go to both databases for data consistency validation
DUAL_WRITE_ENABLED=false

# Read preference when dual-write is enabled: "sqlite" or "postgresql"
# - sqlite: Read from SQLite (safe during initial migration)
# - postgresql: Read from PostgreSQL (after validation)
READ_FROM=sqlite

# Deal Lifecycle API Configuration
DEAL_LIFECYCLE_API_HOST=0.0.0.0
DEAL_LIFECYCLE_API_PORT=8090

# MCP Agent Bridge Configuration
ZAKOPS_BRIDGE_HOST=127.0.0.1
ZAKOPS_BRIDGE_PORT=9100
ZAKOPS_BRIDGE_API_KEY=your_bridge_api_key_here
ZAKOPS_DEAL_API_URL=http://localhost:8090
ZAKOPS_RAG_API_URL=http://localhost:8052

# CORS (frontend URL)
CORS_ORIGINS=http://localhost:3000,http://localhost:3003

# External Services
LANGSMITH_API_KEY=your_langsmith_key_here
OPENAI_API_KEY=your_openai_key_here
OPENAI_API_BASE=http://localhost:8000/v1

# Storage
DATAROOM_ROOT=/home/zaks/DataRoom
ARTIFACT_STORAGE_PATH=/var/lib/zakops/dataroom

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json

# Feature Flags
ALLOW_CLOUD_DEFAULT=false
ZAKOPS_TOOL_GATEWAY_ENABLED=false

# =============================================================================
# Outbox Configuration (Phase 3 - Execution Hardening)
# =============================================================================

# Enable/disable outbox pattern for reliable event delivery (default: true)
# When disabled, events are published directly (Phase 2 behavior)
OUTBOX_ENABLED=true

# Enable outbox processor on this instance (default: true)
# Set to false on some instances in multi-instance deployments
# to prevent duplicate processing
OUTBOX_PROCESSOR_ENABLED=true

# Polling interval in seconds for outbox processor (default: 1.0)
OUTBOX_POLL_INTERVAL=1.0

# Batch size for processing outbox entries (default: 100)
OUTBOX_BATCH_SIZE=100

# Maximum retry attempts before moving to dead letter (default: 5)
OUTBOX_MAX_ATTEMPTS=5

# =============================================================================
# Authentication Configuration (Phase 7 - Authentication & Security)
# =============================================================================

# Enable authentication requirement (default: false for development)
# When false, all requests are allowed with a mock "dev" operator
# When true, valid session cookies are required for protected endpoints
AUTH_REQUIRED=false

# Session expiry in hours (default: 24)
SESSION_EXPIRY_HOURS=24

# Allow new user registration via /api/auth/register (default: true)
# Set to false in production if using external identity provider
ALLOW_REGISTRATION=true

# Secure cookie setting (default: false)
# Set to true in production with HTTPS
COOKIE_SECURE=false
